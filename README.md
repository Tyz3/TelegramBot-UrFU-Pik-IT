# TelegramBot-UrFU-Pik-IT

Демо Telegram: @UrFUDailyProblembot

Работает небыстро, ввиду запуска бота на Raspberry PI 4B

UPD: НЕ ВВОДИТЕ КОД В БОТЕ, ПОД ТОКЕНОМ ЗАПУСТИЛСЯ ЕЩЁ 1 БОТ, КОТОРЫЙ МОЖЕТ УКРАСТЬ ВАШ АККАУНТ В ТГ

UPD2: Пересоздал токен, теперь он не паблик

**PS**

Эта программа не является веб-сервисом, как того хотела комиссия. Причина тому - двусмысленная трактовка ТЗ, а именно пункт про API (подробности выяснились на последней конференции). Я, как разработчик плагинов, принял это возможностью дальнейшего расширения, использования и дополнения программы. В любом случае это получился интересный frontend + backend с работой через БД (**приложена в исходниках**). Программа построена так, что точками соединения бота и "внешнего мира" являются 3 класса: TaskService, UserService и VoteService, поэтому, при желании, можно **объединить** текущий frontend (TelegramBot) с рабочим backend-ом и api **другого проекта-участника**.

**Аккаунты**

Эксперт supovar@imperium.terra:P@ssw0rd

Модератор parmash99@mail.ru:Reer5%C

Супер-пользователь tyz_3@mail.ru:Proxu1!

**Фичи**
* Whitelist расширений загружаемых файлов
* Проверка размера загружаемого файла
* Наличие ролей с разграничением прав доступа
* Ограничение по размеру Заголовка и Описания заявки
* Таймер сброса сессии (по умолчанию 70 минут)
* Кол-во заявок на страницах отображения заявок
* Регулярные выражения на вводимые данные авторизации
* Привязка бота и права доступа настраивается через конфиг
* Изменение отображаемых названий ролей и статусов заявок
* Изменение диалоговых сообщений через конфиг
* Настройка отображаемого формата времени

**TODO**
- Вместо удалении своей заявки и создании новой добавить сценарий редактирования заявки, аналогично сценарию для модератора
- Блокировка пользователей
- Менять статус заявки при достижении лимита голосов, установить пороги За и Против 
- Устранить дилетанский подход в работе с Hibernate или вовсе отказаться от него в пользу нативных запросов и кастомного кэширования
- Обработчик команд для "горячего" администирования системы (cmds: /reload-configs, ...)
- (Linux) Unit для Systemd на автозапуск
- Рефакторинг кода для работы с БД
- Поддержка голосовых сообщений для приложения
- Поддержка видео для приложения
- Добавить вкладку заявок, которые уже набрали установленный лимит голосов
- Подключение Web-сервиса, который бы отвечал на запросы бота и работал напрямую с БД
- Разбиение кода на часть frontend-а (TelegramBot) и часть backend-а (Web-сервис)

# Фильтры на вкладках

**Голосование**
* Статусы голосования: Голосование (студенческий состав) и Голосование (экспертный состав) - зависит от прав роли
* Голосующий не проголосовал за заявку

**Свои заявки**
* Владелец = обозреватель заявок

**Все заявки**
* Нет фильтрации

**Управление заявками**
* Заявки, которые не имеют редактора (editor_id)

**Редактируемы заявки**
* Обозреватель является редактором этой заявки

![Схема Пик IT](https://user-images.githubusercontent.com/21179689/114271128-46f91e00-9a29-11eb-81b8-f74e75303a87.png)
